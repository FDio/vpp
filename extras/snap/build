#!/bin/bash
set -eu

cd ../../build-root
echo "make distclean..."
make distclean > /dev/null 2>&1
cd ../
echo "construct source tarball..."
tar -zcf extras/snap/vpp.tgz --exclude=extras/snap/vpp.tgz .

echo "create the vpp snap"
cd extras/snap

SNAPCRAFT_BUILD_ENVIRONMENT_MEMORY=8G \
SNAPCRAFT_BUILD_ENVIRONMENT_CPU=8 \
   snapcraft --debug

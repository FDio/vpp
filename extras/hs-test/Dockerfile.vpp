ARG UBUNTU_VERSION=20.04

FROM ubuntu:${UBUNTU_VERSION}

COPY --from=hs-test/buildvpp /vpp/build-root/build-vpp_debug-native/vpp/lib/x86_64-linux-gnu/vat2_plugins /usr/lib/
COPY --from=hs-test/buildvpp /vpp/build-root/build-vpp_debug-native/vpp/lib/x86_64-linux-gnu/vpp_api_test_plugins /usr/lib/
COPY --from=hs-test/buildvpp /vpp/build-root/build-vpp_debug-native/vpp/lib/x86_64-linux-gnu/vpp_plugins /usr/lib/x86_64-linux-gnu/
COPY --from=hs-test/buildvpp /vpp/build-root/build-vpp_debug-native/vpp/bin/* /usr/bin/
COPY --from=hs-test/buildvpp /vpp/build-root/build-vpp_debug-native/vpp/lib/x86_64-linux-gnu/lib* /usr/lib/

COPY --from=hs-test/buildhstest /hs-test/hs-test /usr/local/bin/hs-test

RUN addgroup vpp

ENTRYPOINT ["tail", "-f", "/dev/null"]

{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "cebd3400_a1c1da6a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 361
      },
      "writtenOn": "2022-11-15T14:38:01Z",
      "side": 1,
      "message": "Thanks for the report and the patch.\nThat said, I\u0027m not sure it\u0027s the right way to do it: classifier tables are used for other things such as filtering traces or ACLs.\nSo right now it is just a matter of your control plane to enforce that as long as a classifier table is in use, you should not remove it.\nNow, if this becomes too complex, I guess the right way should be to add a refcount and to update all the subsystem using the classifier to inc/dec this refcount, and refuse to remove the table as long as the refcount is not 0.",
      "revId": "baf51b4ff3cd60d0f24fad5887176c75b6ae4d12",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "23a3d23b_9b2485c6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 2841
      },
      "writtenOn": "2022-11-16T01:54:02Z",
      "side": 1,
      "message": "1. I think it\u0027s necessary to refuse to remove the table as long as table is used by any other subsystem. So should I take into account all the subsystems using the classifier table at this patch?\n2. At patchset 1, I used refcount. But shortly afterwards, I changed to use bitmaps, which can indicate it is referenced by which interfaces. I am not sure if it\u0027s necessary to use bitmaps because I think bitmaps is not complex, hope to get any further ideas.",
      "parentUuid": "cebd3400_a1c1da6a",
      "revId": "baf51b4ff3cd60d0f24fad5887176c75b6ae4d12",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "95947ce5_6b7872eb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 361
      },
      "writtenOn": "2022-11-16T13:53:41Z",
      "side": 1,
      "message": "Then I think you should use a refcount and provide a classify_table_lock()/unlock() pair as is done for fib for example and make sure those are call where classify tables are used.\nNot all classify tables are linked to interfaces.",
      "parentUuid": "23a3d23b_9b2485c6",
      "revId": "baf51b4ff3cd60d0f24fad5887176c75b6ae4d12",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1bcbf9df_276fa7ad",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 2841
      },
      "writtenOn": "2022-11-17T01:58:21Z",
      "side": 1,
      "message": "Okay, I know what to do, thanks.",
      "parentUuid": "95947ce5_6b7872eb",
      "revId": "baf51b4ff3cd60d0f24fad5887176c75b6ae4d12",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    }
  ]
}
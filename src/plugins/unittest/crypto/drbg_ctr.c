#include <vnet/crypto/drbg_ctr.h>
#include "crypto.h"

/* NIST test vectors for the AES-128 no df CTR_DRBG, without personalization
 * string nor additional input
 * Generated from
 * https://csrc.nist.gov/projects/cryptographic-algorithm-validation-program/random-number-generators#DRBG
 * with the following command:
 * awk '/^[[]AES-128 no
 * df/{aes=1;count=0}0==aes{next}/^[[]PersonalizationStringLen =
 * 256/{aes=0;next}/^[[]AdditionalInputLen =
 * 256/{aes=0;next}/^COUNT/{count++}/^EntropyInput/{print
 * $3}/^ReturnedBits/{print $3}14==count{aes=0}' CTR_DRBG.rsp|while read
 * line;do echo -n \";echo -n $line|while read -n2 c;do echo -n \\x$c;done;echo
 * \",;done Lines go in pair, 1st line is the initial entropy while 2nd line is
 * the generated output */
static const char *drbg_ctr_vec[] = {
  "\xce\x50\xf3\x3d\xa5\xd4\xc1\xd3\xd4\x00\x4e\xb3\x52\x44\xb7\xf2\xcd\x7f"
  "\x2e\x50\x76\xfb\xf6\x78\x0a\x7f\xf6\x34\xb2\x49\xa5\xfc",
  "\x65\x45\xc0\x52\x9d\x37\x24\x43\xb3\x92\xce\xb3\xae\x3a\x99\xa3\x0f\x96"
  "\x3e\xaf\x31\x32\x80\xf1\xd1\xa1\xe8\x7f\x9d\xb3\x73\xd3\x61\xe7\x5d\x18"
  "\x01\x82\x66\x49\x9c\xcc\xd6\x4d\x9b\xbb\x8d\xe0\x18\x5f\x21\x33\x83\x08"
  "\x0f\xad\xde\xc4\x6b\xae\x1f\x78\x4e\x5a",
  "\xa3\x85\xf7\x0a\x4d\x45\x03\x21\xdf\xd1\x8d\x83\x79\xef\x8e\x77\x36\xfe"
  "\xe5\xfb\xf0\xa0\xae\xa5\x3b\x76\x69\x60\x94\xe8\xaa\x93",
  "\x1a\x06\x25\x53\xab\x60\x45\x7e\xd1\xf1\xc5\x2f\x5a\xca\x5a\x3b\xe5\x64"
  "\xa2\x75\x45\x35\x8c\x11\x2e\xd9\x2c\x6e\xae\x2c\xb7\x59\x7c\xfc\xc2\xe0"
  "\xa5\xdd\x81\xc5\xbf\xec\xc9\x41\xda\x5e\x81\x52\xa9\x01\x0d\x48\x45\x17"
  "\x07\x34\x67\x6c\x8c\x1b\x6b\x30\x73\xa5",
  "\xd4\xf4\x7c\x38\x5e\x5e\xe3\x69\x15\x97\x83\x86\xa0\x74\xd4\x13\xd0\x4a"
  "\x1c\xe3\xa1\x3a\x0f\xe2\xb1\x7f\x3f\x20\xf8\x3a\x93\xfd",
  "\x27\xf8\x80\xdf\x4c\x29\x07\x69\x7f\xb2\xf5\x94\xe3\x11\x55\x9c\xea\x82"
  "\x70\x49\x32\x7a\xf3\x1f\xa7\xf0\xcb\xf3\x32\xc4\x62\x06\x74\xf5\x03\xd7"
  "\xdc\x37\x83\x20\xd2\x28\x90\x71\x51\xd3\x2e\xe5\xe3\xf5\xc5\xec\xcb\x13"
  "\xaf\xe5\x8b\xf6\xa6\x01\x92\xe6\xd7\x0e",
  "\x12\x3d\xd8\x2c\x6a\x8d\x6a\x5f\x23\x06\x77\x02\xe8\x22\x27\x33\xa3\x9c"
  "\x48\x96\x5b\xac\xcd\x9b\xff\xed\x5d\xc5\x1c\xb7\x89\xb6",
  "\x12\xdd\x6a\x87\x4a\x46\x56\xc7\xd5\xa2\x1c\xb1\x17\x9b\x3c\x4a\x99\x82"
  "\xae\x00\xfc\x1b\xf2\x6c\xb3\xa1\x39\xcb\x21\xc4\x50\x50\x45\xff\x5e\x22"
  "\x3e\x2d\x08\x1f\xee\x52\xb2\x22\x46\xd4\x85\xb9\xf1\x27\x4a\xef\x79\xa3"
  "\x30\x1d\x26\x36\x99\x97\x99\xaa\xd3\x1d",
  "\xf1\xa6\x9a\xf8\x90\xb2\xc9\x79\xfa\xe0\x46\xa2\xb5\x8d\x00\xa8\x33\x1c"
  "\x53\x22\x47\x2b\x0e\x61\x9b\xb3\x72\xbf\xd0\x27\xf7\x05",
  "\x96\x09\x12\x58\xc4\x22\x4e\x3b\x03\xd6\x5c\x93\x8c\x97\x83\x2b\x55\x14"
  "\x30\x69\xdb\x57\x55\x19\x6d\x52\xf5\x25\xbe\x95\x9d\x51\x9b\x1e\x02\xe5"
  "\xf2\xda\xbf\x4d\xd2\x16\x4f\x9b\xb0\x6a\x16\xa6\x35\x76\xff\x6d\xeb\x04"
  "\x2d\xab\x74\x03\x39\x16\xc9\x54\x98\xc1",
  "\x14\xa9\xa1\xe2\x0c\xa3\x68\x6f\x3e\xc0\x96\x03\xf6\x73\x0b\xdd\x73\xa9"
  "\xcc\x8c\x32\x38\x8e\xc0\x0b\xc2\x8e\x6c\x9e\xc6\x5d\x87",
  "\xc1\x29\x46\x45\x7a\xd8\x9d\xde\x78\x8e\x13\xc5\x09\x2b\xbf\x3e\x9c\x7f"
  "\x61\xea\xc7\x32\x61\xd0\x1d\x39\x6a\x1d\x9d\x11\x63\xee\xe8\x47\xa5\x61"
  "\xd8\xe5\x20\x80\xcd\x9b\xdc\xe5\x70\x14\x17\x82\xeb\xf1\x67\xc4\x70\x0a"
  "\x66\xac\xa6\xfd\x5c\x91\x16\xa7\xbe\x49",
  "\x97\x26\x1a\x2c\x19\xc6\xdc\x36\xa6\xd0\x28\x3a\x17\x7e\xb9\x66\x6c\x21"
  "\x81\x7f\xc0\xfc\xa4\x62\xc5\x3d\x90\xb3\xd8\x14\xcd\x92",
  "\xb4\x74\xf2\x74\x3b\x61\x82\xb0\x51\xfc\x7c\x76\xc6\xb4\x08\x5b\x2f\x59"
  "\x76\x39\xca\x19\xc1\xee\xe0\x5c\x1c\xf4\x39\xbb\x8e\xdb\xe0\x93\xd0\xb2"
  "\x23\x9d\xe5\xd0\xf7\x9b\xeb\xf0\xe6\x22\xfe\x04\xb5\x13\x59\x7e\xd1\xd8"
  "\xa0\x28\x21\xa0\xbc\xa4\x35\xd1\xfb\xde",
  "\x9f\xdd\xe0\xf7\xeb\xa6\x53\x81\xbf\x63\x7d\x7b\x7e\x6f\xbc\x20\xde\xef"
  "\x90\x60\x13\x01\x86\x55\xf8\xd1\x2d\x74\x7d\xb8\xe2\x25",
  "\xf4\xa5\x5a\xa4\xc2\x45\xcd\x42\xa1\xb6\x42\x96\x37\xb0\x77\x41\x89\xef"
  "\x4e\x50\x53\xbe\xf0\x6b\xbf\x42\x2b\x2f\x10\x39\x9e\x18\xb9\xf8\x6d\xcc"
  "\x56\xaa\xa6\x97\x5e\xa1\x56\x22\xcd\xeb\xf3\x6a\x3f\x47\x78\x44\x7b\xb2"
  "\x3a\x20\x44\xc2\x83\xa7\x99\x03\xbe\xac",
  "\xaf\x62\x29\x9f\x37\x89\x53\x32\xd2\x83\xff\x9f\x3b\x0c\xa2\x9f\x90\x03"
  "\x57\x18\x93\xdd\xd1\xbc\x2d\x28\x63\x3a\x33\x99\x2b\x4a",
  "\xb9\x17\x19\xf2\xd1\x29\x7f\xa9\xc5\x17\x20\xab\x94\x48\x22\x8e\x33\x35"
  "\x94\xa7\xa1\xc0\xa5\xd7\xa1\x0a\xe8\x82\x49\xdc\x0c\xc5\xd0\x7a\xbe\x20"
  "\xb7\x91\x5d\x2a\x87\xf1\x2e\xc4\xbc\xdf\x44\xef\xa9\x11\xf2\x8c\x5e\x9e"
  "\x39\x09\x01\x8e\x4a\x6b\xd1\xb5\x36\x3b",
  "\x42\xfe\x0a\xd0\x88\xd5\xc1\xd6\xbe\x9e\x02\xc1\x47\xd5\x77\x0c\x9a\xa0"
  "\xa9\x77\xc6\x30\x0c\xd9\xae\xc9\x40\xcd\x15\xec\xfb\x8d",
  "\xbd\x1a\x65\xbb\x65\xb5\x5e\xc4\xd6\x27\x9c\xb9\x4d\xbf\x3b\xcd\x82\xbc"
  "\xe0\x9f\xa2\x77\xbf\xea\x50\xb5\xda\xb6\x4b\x06\xc0\x18\x15\x70\x03\x2a"
  "\x3a\x6f\x7d\xee\x5b\x2c\xce\xa3\x4b\xc6\x92\x8d\xb1\x1d\xec\x93\x29\xed"
  "\x90\xd1\x09\xc0\xbc\xca\x7c\xe7\xa4\x28",
  "\x74\x4e\xd7\x4d\x83\xba\xcf\x92\xd4\xbd\x4d\xd0\x52\x45\x8b\xd8\xaf\x10"
  "\x39\x1c\x66\xfc\x89\xe1\x39\x74\x42\x63\x20\xaa\x47\x4a",
  "\x8d\xdd\x02\x70\xb0\x7f\xbb\xd3\x39\xbc\x83\xea\x7a\x1d\x98\x6e\xe8\xe1"
  "\xa0\x61\xc7\xe3\x1c\x5d\xbd\xcc\xab\xc8\xf2\x52\x27\x83\x2e\xc4\x5f\x5e"
  "\xf9\xf2\x8c\xa0\x44\x6d\x84\x4d\xaa\xdd\x19\x20\x24\xc4\xd3\x68\x54\xfa"
  "\x23\xb5\x8a\x8b\x97\x94\xdb\x6d\x3a\xcb",
  "\x88\x4e\x9f\xaa\x66\x1d\xce\xcc\x37\x65\xc7\x97\xa2\xaf\x89\x06\xfb\x89"
  "\x38\x13\xa3\x96\xe0\x2b\x94\x99\x38\x26\x28\x8d\x2a\x6d",
  "\x18\x48\x1d\xc4\x5c\xa3\xf1\x89\x6f\xe6\x39\x4a\x23\x67\xd4\x4c\x4e\x45"
  "\x8b\x45\x5c\x9f\x36\xa5\xd5\xac\x2b\x6a\x74\x75\xcf\x75\x99\xa9\x37\x8f"
  "\x9c\xc7\x2f\xfc\xdb\xea\x71\xf0\x9c\x9a\x24\x4a\x36\xcd\x66\x0b\x72\x25"
  "\x46\xea\x2a\xf4\xf3\xe7\x75\x96\xec\x25",
  "\x31\xd1\x08\xfe\x0d\x40\xfe\x05\xc9\xed\x83\x72\xc3\xbc\x09\xd1\x05\x8b"
  "\x39\x7b\x90\x06\xfb\x37\x3c\xdd\x16\xa5\xa4\x0e\x2c\xc1",
  "\x80\x82\x24\x50\xb0\x48\x7e\x70\xad\xa9\x48\xda\x0b\x25\xcc\x49\xa3\x7d"
  "\xc5\x8e\x0d\xad\x92\x33\xba\xdd\x0e\x88\xdf\x52\x0d\x36\x54\x30\x0f\x08"
  "\x1b\x02\xe8\x54\x5d\x6d\x68\x18\xb8\x2e\x45\x96\x4d\xb8\x63\x3f\xc7\x69"
  "\xaf\x84\xa9\x79\x9e\x92\xa1\xbb\x0d\x61",
  "\x69\xa0\x9f\x6b\xf5\xdd\xa1\x5c\xd4\xaf\x29\xe1\x4c\xf5\xe0\xcd\xdd\x7d"
  "\x07\xac\x39\xbb\xa5\x87\xf8\xbc\x33\x11\x04\xf9\xc4\x48",
  "\xf7\x8a\x49\x19\xa6\xec\x89\x9f\x7b\x6c\x69\x38\x1f\xeb\xbb\xe0\x83\x31"
  "\x5f\x3d\x28\x9e\x70\x34\x6d\xb0\xe4\xec\x43\x60\x47\x3a\xe0\xb3\xd9\x16"
  "\xe9\xb6\xb9\x64\x30\x9f\x75\x3e\xd6\x6a\xe5\x9d\xe4\x8d\xa3\x16\xcc\x19"
  "\x44\xbc\x8d\xfd\x0e\x25\x75\xd0\xff\x6d",
  "\x80\xbf\xbd\x34\x0d\x79\x88\x8f\x34\xf0\x43\xed\x68\x07\xa9\xf2\x8b\x72"
  "\xb6\x64\x4d\x9d\x9e\x9d\x77\x71\x09\x48\x2b\x80\x78\x8a",
  "\x80\xdb\x04\x8d\x2f\x13\x0d\x86\x4b\x19\xbf\xc5\x47\xc9\x25\x03\xe5\x80"
  "\xcb\x1a\x8e\x1f\x74\xf3\xd9\x7f\xdd\xa6\x50\x1f\xb1\xaa\x81\xfc\xed\xac"
  "\x0d\xd1\x8b\x6c\xcf\xdc\x18\x3c\xa2\x8a\x44\xfc\x9f\x3a\x08\x83\x4b\xa8"
  "\x75\x1a\x2f\x44\x95\x36\x7c\x54\xa1\x85",
  "\xa5\x59\xac\x98\x72\x79\x1d\x79\x19\x7e\x54\xda\x70\xa8\xd8\x58\xfb\xe3"
  "\x9e\x85\x14\xd2\xc8\x6a\x7b\xcf\xfa\xdc\x68\x78\x2e\xdf",
  "\xd1\x4b\x72\xe1\x7c\x2f\x6f\x77\xb4\x6d\x07\x17\xb7\x88\x42\x0e\x50\x3b"
  "\xb1\x8d\xe5\x42\x13\x5f\x58\x6a\x90\xc5\xc7\x3f\xce\xee\xe5\x0f\xd1\x63"
  "\x3b\x5b\x09\xab\x06\x1b\x93\x67\xca\x78\x5e\xcb\x40\x0e\x1f\x36\x81\x58"
  "\x36\x61\xaa\xf8\x35\x21\x84\x45\x4a\xe6",
  "\x30\x0f\xe1\x48\xdd\x39\xde\x1e\xdb\x99\x3c\xa5\x26\x03\x73\xb3\xf5\xf0"
  "\x9a\x5c\xf7\xa3\x2b\x0c\x41\xfe\x62\x24\xf9\x81\xd3\xb1",
  "\xde\xea\x89\xb5\x12\x8f\xb9\x92\x69\x6d\x7b\x97\xeb\xc2\xc0\x79\x36\x14"
  "\xb1\x72\xf4\xc7\x5b\xb8\x3c\x12\xa1\xb3\x89\xba\xc3\xbf\xec\xb7\x73\xcd"
  "\x77\x17\x58\x3c\x2b\x61\xb3\xb2\x43\xac\x96\x83\xdb\xa4\xfb\xc0\x71\x82"
  "\xba\xd8\x27\x1a\x7f\x16\xd8\x33\xe4\xd9",
  "\x0c\x6e\xe2\xa5\xd4\x63\x25\xba\xa8\xe9\xa3\xf6\xb5\x98\xfc\x79\x0c\x51"
  "\x3d\x38\x7d\x47\x00\x11\x16\xd1\x9a\x61\x4d\x20\x38\xc4",
  "\xf1\xee\x11\xbe\x18\x92\x63\xfe\xd9\x93\x2c\x11\x92\x21\x9d\x00\x37\x8e"
  "\x36\xce\x81\xa4\x31\x31\x85\x45\xda\x9f\x81\xf5\x0c\x29\x13\xd1\xf7\xbe"
  "\x49\x9c\xe9\xe1\xe3\x9f\x93\xee\x23\x60\x66\x8f\x12\x73\x40\x69\x1c\x17"
  "\x71\x17\x07\xcf\x5f\x1f\x8a\x4d\x93\xee",
  "\xbd\xbb\xa1\xad\x48\x03\xfd\xc7\x83\xef\x5d\x6e\x2a\xa6\x6d\xc9\x48\xe9"
  "\x60\xbc\x11\xcc\xa8\x9a\x60\xcf\xf5\xc6\x0e\x98\x43\x02",
  "\x26\x0a\x32\xc3\x97\x37\x50\xe0\xc1\x0f\x7f\x74\x95\xd4\x6e\x7c\x36\x91"
  "\xc2\x7a\x58\xe8\x28\xcd\xef\x48\xef\x66\x07\x16\xf7\x71\xd6\x1c\x3c\x76"
  "\xdb\x40\x7d\x81\x60\x66\xf5\xaf\xbf\x16\x99\x34\x85\xcd\xb6\x53\xd4\x18"
  "\xdd\x65\xff\xa5\xd3\x82\x57\x32\xb8\xcb",
  "\x22\x58\x7b\xfd\xce\x62\xf4\xaf\xc1\xdd\x26\x73\xf5\x30\x83\x64\xf2\x7d"
  "\xb9\x91\x2a\xd0\x1b\x04\x5e\x74\xdb\x45\x18\x43\x59\x59",
  "\xc9\x04\xd0\x30\x89\xb7\xdd\x1f\x17\x56\x4a\x7e\xf7\x0b\x17\xbb\x1b\x29"
  "\xc0\xc1\x79\x3c\xc8\xd9\x2b\x8c\x15\x8c\x04\xca\x53\x66\x91\x9f\x8c\xaf"
  "\x54\x4d\x5d\x07\xc2\x8a\xbe\x6d\x14\xba\xaa\x0c\x56\x60\x2d\xf1\xc3\x73"
  "\xe9\xac\xc4\x19\xe3\xc9\x32\xe5\x77\xe6",
  "\x8a\xbe\xfb\xb2\x3d\xfd\x58\xd8\x2b\x88\xa4\xc4\xfc\xfc\xee\x18\x3c\xe0"
  "\x1d\xb9\x75\xed\xee\xb4\x04\xbd\x21\x6e\x61\x77\xea\x0d",
  "\x8a\x70\x8e\x8a\x99\x03\x53\x89\xa4\xd6\x6d\x57\xd1\x2f\x48\x8e\xcb\xa5"
  "\x7a\x3b\x2c\xa7\x80\x15\xbe\xda\xe0\x6a\xaa\x41\x4d\x79\x11\x96\xe2\x62"
  "\xb2\x8f\xbd\x74\x5d\xff\x94\xf8\xfe\x60\x06\x87\xc9\xce\x2f\x50\xcf\x6d"
  "\x79\xd3\x9b\x8c\x5e\xa3\x65\x33\x75\x5d",
  "\xc4\x5c\x9f\xec\x6b\xb8\x3f\xb0\x80\x08\x87\x7c\x70\xb6\x32\xd7\x92\x11"
  "\x9a\x35\xc4\xc5\x98\x8c\x40\x26\xcf\x3f\x86\x12\xb8\x00",
  "\x84\x43\x0e\x49\xa9\xb4\xd3\x95\xd0\x55\xca\x0e\xfd\xf2\x85\xa7\x55\x1c"
  "\x5f\x71\x19\xdb\xea\x5c\x10\xda\xaa\x9e\x8b\xe0\x41\xe2\x3e\x9b\xc8\x93"
  "\xc9\x0a\x35\xb7\x7b\x19\xdc\x20\x2e\xc8\x34\x17\x2e\x6c\x8c\xea\x97\xc9"
  "\xd7\xc6\x8d\xf1\x37\x4a\xee\xa9\x45\x37",
  "\x58\xcb\xcc\xd7\xf8\x6e\x5f\x04\x72\xdc\xb3\x77\xf5\x98\xf2\xd4\x2e\xd9"
  "\x6a\xfd\xf0\xc8\xe4\x5f\x12\xc4\xff\x4a\x96\x9c\x5b\x6b",
  "\x41\xff\x55\xd0\x58\xbe\xaa\x04\x30\x8b\xd0\xb3\x9d\x48\x01\xf7\x0f\x23"
  "\xd8\x29\x03\x7e\x4c\xc9\xb2\xea\x0e\xac\xf5\xae\xf9\xb8\xe3\x3f\xc5\x9c"
  "\x52\x8b\x53\xbc\xe0\x8d\x2b\x53\x6d\x37\xbf\x19\x4c\x79\x7f\x03\x29\x04"
  "\x94\xdd\x00\xef\x24\x4a\xc2\x23\xe3\x50",
  "\xd5\x05\x58\xdf\xb7\xa8\x96\x6c\x63\xb3\xa1\xd0\xa8\x37\x97\x0a\xd0\xbf"
  "\xf5\xad\xbd\x8a\xda\xca\xe5\xd3\xac\xcf\xde\x64\xcd\x4d",
  "\xe9\x13\x61\x51\x1d\x92\x6b\xe4\xd9\x97\xfc\x97\x0b\x1a\x5d\xcd\xb3\x3a"
  "\x71\x1f\x21\x5c\xbd\xbf\xfa\xbf\xcd\xaa\x62\x48\x59\x68\x91\xd5\x5a\x9e"
  "\x64\xf4\xe9\xf5\x18\x5e\xd7\x05\x6f\x7c\xbb\x42\xf4\x74\xa2\x35\x42\xfe"
  "\x9e\x9c\x24\x95\x18\x2c\xef\xb3\x8a\x6a",
  "\xf7\x0c\xe2\x83\xef\xd5\xba\x36\xc2\x84\xcb\x26\x7d\x22\xe2\x3d\xc4\x16"
  "\x71\xb2\xaa\xae\x98\xe6\x38\xc6\xe4\x51\xbc\x9c\x3c\xbb",
  "\xfd\x9b\x3b\x53\xe1\x2b\x67\x02\xe4\xc6\xe4\xac\xac\x33\xae\xae\x5c\xeb"
  "\x34\xce\xbf\xff\xa7\x00\x7c\xb1\xab\x1c\x3b\x4b\xe1\xa3\x8e\x5c\x86\xde"
  "\xa0\x77\x5a\xb0\xc8\x9a\xe1\x35\xe0\xb3\x6d\xa0\x87\x92\x1d\x3f\xf2\x75"
  "\xff\xc8\xe5\xdc\xee\x6e\x3d\x66\xee\x43",
  "\x58\xeb\x54\x4f\x44\xdf\xe1\x04\x8a\x81\x13\xd4\xb6\x90\x90\x50\xab\xf9"
  "\x01\x00\x36\x23\x3b\xe7\xf8\xfc\xc4\x1f\x39\xba\xff\x9c",
  "\x5c\x6a\xed\xc0\x20\xe7\x64\xf4\xd3\xbb\x8a\xbc\x29\x07\xc9\xc6\x04\xdd"
  "\x98\xe1\xcf\xc2\x88\x2e\xa7\x2d\x55\x4e\x39\xfe\x86\x46\x3a\x51\x88\x6d"
  "\x98\x0a\xc8\xcd\xda\x0f\x4e\x58\x42\x26\xd4\x53\x44\xe4\x3d\xd8\x4e\x84"
  "\x30\xf5\x8c\x38\x80\xa0\xce\x93\x08\x63",
  "\x48\xe8\x27\x1c\x4b\x55\x4d\x9d\xa3\xf8\x8c\x82\x0d\x07\x8f\x6a\x3f\x66"
  "\xac\xf0\x07\xcc\x98\x84\x0e\x03\xe2\x6c\x62\x52\x7f\x91",
  "\xb9\xa9\x56\xa6\xe3\xd1\x03\x10\xe5\x7e\x28\x7c\x28\x4c\x68\x67\xed\x9e"
  "\x80\x84\xa6\x2b\x25\xc4\x92\x18\xfa\x3a\xed\xe7\xc6\xea\xec\x16\x22\x69"
  "\x66\x40\xf6\xb4\xad\x53\x79\xc6\xfb\x8f\x9b\x5d\x72\x02\xad\x89\x10\x5d"
  "\x03\x17\x34\x87\xe2\x9d\xa9\x73\x93\x90",
  "\xb1\xc3\x47\xb0\x96\x65\x31\x0d\x0d\x04\x87\x93\x5e\xa8\x1b\x4f\x73\x44"
  "\x83\x86\xcf\x08\x01\xcc\x9d\x6a\x0b\xb6\x55\x60\x2c\x29",
  "\xa6\x19\xe2\x6d\x7a\xcf\x6b\x82\x84\x51\x56\x2f\x51\x75\xc2\xa9\xaf\xb7"
  "\x3c\xe3\xa7\x26\x5b\xea\x38\xb8\xf3\xbd\xe9\xf4\x26\xcf\x55\x2f\xff\x34"
  "\x35\xea\xbb\xfb\x72\x44\x6d\x90\x76\xee\x00\x45\xbf\x82\xca\xff\x76\xd9"
  "\x01\x23\x7f\x7b\x6e\x33\xe6\xac\xdf\x9a",
  "\x4a\xdf\x8e\xbf\xf3\x58\x8c\x1d\x86\xf8\xb0\xa7\x0f\x55\x85\xcd\x7f\xa6"
  "\xe1\xa1\x17\x6e\x79\x1b\xeb\x37\xb5\xa2\x51\x25\xd2\xab",
  "\x8b\xfd\x73\xea\x99\x09\xcb\x62\x24\x8f\x97\x2c\xa7\x7f\xd6\x53\x79\x24"
  "\xfb\xf5\x84\x7b\xd6\xb2\x9b\x2f\xe3\x67\xf8\xdd\x2f\xe2\x2c\xad\xeb\x8b"
  "\x6e\x32\x85\x6d\xcf\xf8\x11\xda\x72\x48\x3e\xf1\x64\xcf\xa6\x78\xde\xb4"
  "\xf9\xaf\x38\x1e\xfe\x2d\x70\x28\x82\x92",
  "\x28\x5d\xe6\x16\xb8\xba\x8b\xb5\xf6\x46\xfe\x43\x60\x16\x45\x45\x4e\xc7"
  "\xd7\x08\xf4\x42\xfb\x1f\xfd\xea\x09\xae\x10\xac\xc0\x64",
  "\x31\xbe\x55\x8c\xa1\x3f\x23\x8d\x59\x6e\xc5\xdb\x02\xd4\xf0\xb9\x23\xbf"
  "\x01\x64\x9d\x1a\x51\xf4\xcd\x27\xfc\xd7\x7b\xa2\x9e\x46\x30\xef\xc9\x13"
  "\xbd\xa1\xdb\xed\x32\x0c\x7f\x4c\x8d\x69\xac\x7f\xb3\xec\xcc\x25\x9b\xca"
  "\x82\xe4\x79\x59\x9f\x3a\x67\xb1\x79\x22",
  "\x14\x5b\x3c\x65\xaf\xb2\xfb\xae\x1c\xd7\x65\x25\xb2\xd5\x32\x5c\xc4\x30"
  "\xcd\x4e\x1c\x8a\x63\x76\xbf\xc7\xa3\x02\x3b\xb8\xf5\x9d",
  "\x56\x60\x03\x5f\x34\xbc\xc6\xcc\xab\xae\xcb\x15\x83\x82\x7c\x9f\x0f\xf4"
  "\x3e\x0e\xcb\x22\x26\x9c\x06\x93\x63\xc0\x5e\xc2\x82\xbc\x5f\x4d\x4a\x42"
  "\x62\xe1\xe0\xa0\xfb\x66\x7a\x28\x5a\x3f\xde\x69\x05\x2c\x91\xc7\x3d\x04"
  "\x32\xd9\x12\x35\xbf\x4f\x90\x37\x3a\x22",
  "\xb8\x0c\x0a\x02\xb6\xfc\x7b\xfc\x05\x15\x88\x00\x05\xc0\xa2\xc1\x8e\xf5"
  "\xb8\x12\x99\x15\xfd\xac\x34\xbc\x94\x6c\xb4\x80\xc0\xfd",
  "\x82\xef\x2a\xf1\x4b\x58\xfc\xe2\x9d\x33\xf9\xf1\xb5\x26\x18\xf2\x30\x24"
  "\xdd\x17\xdc\x81\x33\x74\x9b\x59\x98\x15\x0f\x44\xf4\xde\x8f\xa2\x8f\x62"
  "\xc4\xdf\xeb\x2b\xb7\xbc\xc4\xf5\x14\xaf\x9a\xd2\xc7\x64\x20\xd3\xe4\xcf"
  "\x7c\xc5\x35\xc5\x56\xe1\xe7\x3a\xcc\x54",
  "\x1a\xea\x93\x80\xee\x1c\x38\x37\xfd\x57\xb6\xae\x69\xca\xe7\xd1\xa8\x16"
  "\x63\xc2\xc3\x69\x19\xa8\xfb\x46\x39\x8a\x77\x57\xd7\xbf",
  "\x9b\xf9\xe4\xee\xee\xf1\x18\xd6\x75\x49\x44\xb8\xed\xd4\x6d\xea\x37\x97"
  "\xd8\x21\x9d\xfb\x9d\xec\x11\x86\xbb\xe2\xa9\x87\x6e\x60\x4a\xd5\x2c\x02"
  "\xd0\x2e\xa0\xa9\x80\x29\xe8\x83\xff\xf8\xb6\x04\x39\xe6\xc3\x58\xb2\x6c"
  "\xb0\xea\x40\xf0\x31\x9a\x37\xf3\xea\x87",
  "\xf2\xa7\x11\xe4\xe5\xf0\x55\x1a\xe7\xc7\x91\x6a\x95\xe7\x65\x42\xa4\x4c"
  "\x9a\x02\xc7\x15\x35\xfd\x02\x0b\x2d\xb1\x68\xf4\x3d\x31",
  "\xcb\x8a\xc7\x86\x03\xa6\xb4\x4f\x05\x7f\x8f\xa3\x48\xe1\x98\x71\x06\xd5"
  "\xaf\x6b\x92\x93\xff\xe3\x72\x6b\x46\x24\xba\x04\xc6\x0a\x27\xb2\x1a\x62"
  "\x62\x24\x74\x8e\xcc\x11\x1c\xd1\xef\x10\x2d\x62\xd8\xe9\x0c\xd5\x14\xef"
  "\x04\x51\x67\x18\x53\x05\x00\x67\x8f\x20",
  "\x15\x9c\xc9\xeb\x22\xaa\xfb\x9c\xe3\x1a\x7e\xe2\xf8\xe6\x17\x15\x24\xc7"
  "\xd7\xbc\x04\x56\x32\xad\x04\x3d\x73\x1d\x00\xfb\x2a\x67",
  "\xa2\x31\xa1\xab\x27\x3a\x29\x7b\xd4\x43\xf1\x43\x59\x92\x35\xcf\xdf\xc7"
  "\x23\x59\xbb\x69\x39\x4a\xf0\x91\x79\x60\xec\x43\xae\x17\xaa\xe4\x62\x32"
  "\xf8\x27\x3e\xdd\x86\x4b\x8b\x07\xa6\x13\xe9\xfc\x26\x56\xe8\x95\x30\x0f"
  "\xd1\x7a\x9e\x28\x60\xd4\x5d\xb6\x1e\x8c",
  "\x1e\xbc\xcb\x0d\xd5\x03\xec\x20\xe5\x8b\xb4\xd8\xc2\xec\x67\xf2\xe8\xdc"
  "\x3a\x04\x36\x1d\xaf\xc8\x1c\x0c\x0b\x61\x1a\xf2\x76\xa2",
  "\xc6\x4d\xb3\x84\xb4\xb7\xb0\x54\xb0\x0d\x31\xbb\x94\xc0\x27\x35\x0e\x7a"
  "\x5c\x2f\xe0\x0e\xef\x37\x15\x6c\x94\x63\x9c\xdb\x04\x33\xfb\x31\xbe\x02"
  "\x37\x01\x9b\xfa\xf6\xf9\xc5\x49\xff\x77\xd5\x23\xb5\xb5\x3c\x07\xd1\xe0"
  "\x0f\x79\xb0\x74\xb7\xfb\x5c\x78\x14\xe4",
  "\x6d\xbf\x76\xe7\x8b\x9a\xf7\x74\x4c\x84\xa2\x4e\x5d\x9a\x4b\x42\x49\x32"
  "\xb1\x9e\x6a\x62\xa9\xab\x3a\x04\xb3\x2c\x76\xee\xf7\xde",
  "\xea\x09\xfc\x60\x69\xb9\x9c\x9e\xd1\x16\xdf\x49\x47\x1b\xe2\xd7\x26\x17"
  "\x10\xa8\xaf\xba\x1c\xf3\xa0\xd3\xf3\xd2\x2d\x80\x72\xb0\xb5\x0e\x00\x3d"
  "\x7f\xab\x02\x11\xd5\xa4\x4d\x6f\x75\xf4\x54\x1f\x5b\x97\x3e\x72\x71\x05"
  "\xe0\x29\x7c\x3b\x9f\x0c\xa9\x4e\x00\x43",
  "\xb0\xa4\xfa\x9c\xc2\xa5\xb4\x28\xdd\x92\x4c\x31\x2d\xcc\x05\x4b\xfb\xf7"
  "\x4c\x0f\x9c\x38\xed\x02\x40\x04\x6f\x35\x4d\x2f\xc6\xb2",
  "\x6f\x51\x33\x61\xb3\x07\x6f\x5e\xac\x6c\xa5\x40\x86\x9b\xdc\x40\x11\x88"
  "\xf9\xe4\xbe\x25\x34\x8e\x22\xa6\xb8\xda\xa0\x43\x11\xb5\x27\x84\xba\xff"
  "\x3c\x2a\x11\xca\xf0\x3d\xea\xc3\x64\x31\x74\xb0\xc8\xe4\x4b\x54\x4c\x0b"
  "\xbb\x4d\xa7\x24\x1b\xbf\x65\x7e\xc1\x76",
  "\x85\x7a\x11\x86\xa0\x82\xd7\x7e\xd7\x89\x3b\xb4\x67\xda\xa7\x95\x76\xd1"
  "\xfc\x66\x7e\x07\x11\x74\x90\x52\x2f\x87\xee\x19\xbb\x9f",
  "\xfb\x88\x89\xbf\xe0\x08\xf0\xd4\x50\x34\xc2\x6b\xb0\x41\x4f\xf1\x95\x13"
  "\xb6\xc4\x44\x5a\xcc\x4a\x56\x3f\x6d\xf9\x55\x2e\xc5\xdf\x95\xf8\xcc\x71"
  "\x43\x75\x7e\x74\x06\xfe\xb4\xf5\xbe\x7f\x1b\x65\x76\x04\x90\xdf\x90\x29"
  "\x8e\x73\x05\x58\x30\x94\x3d\xbd\x7c\x38",
  "\x08\x4b\x35\x2f\x38\xab\x28\xd9\xc1\xc7\xff\x16\x55\x8e\x0a\x12\x37\x7d"
  "\x82\x0c\xd6\xec\xa3\xa3\x52\xa6\xfe\xc3\x81\xf3\x58\x44",
  "\xcb\xdf\xff\x95\xde\x29\x06\xf3\x42\x3e\xb4\x42\x2b\xd3\xb0\xe6\xed\x55"
  "\xa7\x84\x3a\xb6\xeb\xed\xf5\x2a\xca\xf2\x8e\x7a\x5a\xe0\x61\xae\xdb\x49"
  "\xe7\x47\x67\x83\xf5\xcf\x29\x54\x16\x8c\x8e\xbc\x3c\x9a\xb0\xb1\xa1\xcb"
  "\x87\x90\x76\xb4\x76\x97\xb3\x6f\x95\x40",
  "\x8c\x25\x66\xac\x86\x0f\x23\x2f\xa3\x17\x08\x7f\x84\xf0\x17\x6f\x98\xf5"
  "\x7e\xc0\x87\xae\x8c\xae\x97\x52\x7b\xea\x92\x24\xab\xf1",
  "\xa6\x64\xd3\x1a\x2f\xa0\x8d\xd1\x6a\x2b\x89\xf6\xbc\x60\xeb\x52\xe4\x7d"
  "\x99\x78\x23\x94\x04\x1e\x39\x1d\x9f\x56\x86\x24\x7a\xa2\x43\x00\xe4\x87"
  "\xa7\x30\xd5\x20\x0d\xfd\xec\xcc\x47\x4d\x22\xf5\xaa\x8e\xd5\x23\xc3\xa0"
  "\xf6\x29\x7d\xc5\x33\x93\x65\x92\xac\x3f",
  "\x09\xc8\xe3\x92\x2a\x75\x6b\xfa\x74\x0d\x09\x23\x42\x55\xe0\xfc\x4b\x1b"
  "\x46\xe3\x51\x39\x69\xd2\x42\x44\xb0\xd9\xb4\x92\xfb\x26",
  "\x31\xc5\x02\xfe\x08\x77\x5f\x53\xfb\xaa\x52\xde\x6e\xc5\x3e\xd9\x68\x87"
  "\xee\x6c\x49\x74\x3b\xc5\xa8\x8b\x01\x6f\x46\x95\xa6\xf5\x35\x2c\xd6\xf1"
  "\x82\xb2\x7a\x50\xb3\x75\x50\x64\x4a\x51\x8e\xfc\xcc\xc8\x47\xae\x08\x78"
  "\x07\x66\xaa\xb2\xd0\x98\x4d\xc1\x37\xe6",
  "\x6e\xb0\x55\xa3\x30\xf2\xc1\x81\x77\x48\x18\x5d\x5c\xf1\x18\x62\xe2\x7a"
  "\x17\x3c\x7c\xaa\x98\x31\x28\xac\x7d\x35\x6d\x39\xf4\x40",
  "\x3a\x34\xb6\x91\x1f\xe2\x7f\x5d\x5b\x4d\xa7\x56\x1f\xb5\x7d\xb8\xfc\xee"
  "\x03\x93\x88\xca\x9b\xba\x1f\xf1\xdb\x8f\xf5\x80\x96\x26\x3e\x96\xb0\xb0"
  "\x67\xe2\xc6\xea\xf4\x88\xf2\x99\xd3\x70\x51\xc5\x95\x05\x87\x26\x01\xe2"
  "\x8b\x9d\x2a\xf7\xdb\xd8\x9f\x23\x54\x07",
  "\x70\xb3\x40\x65\x29\x9c\xab\xb6\x72\x89\x09\xfa\xfe\x37\xd6\xb2\x68\xfe"
  "\x9f\xdc\xff\x83\x3e\x63\x8f\x13\x4c\x02\xd2\x32\xb4\xee",
  "\xcb\x78\xab\x06\x75\x91\x15\x5f\xcd\x3a\x89\x20\x53\xd9\xb2\x71\xac\x05"
  "\xa8\xc7\xc3\x23\x38\xbf\x63\x90\x18\x4a\x46\xf0\x7f\x8a\x47\x57\xb0\xe0"
  "\x3e\x94\x75\x8b\x14\x3d\x5a\x23\x30\xc6\xb8\xf8\x8a\xa6\x21\xeb\x10\x20"
  "\x50\x96\x29\x40\x78\x8a\xec\x9b\xe6\x54",
  "\x61\xba\x1e\xd5\x28\xe5\xa6\x07\x09\x81\xcd\x5c\x11\xb4\xbe\x2c\x2c\x57"
  "\x35\x9d\xf0\x61\xc3\x05\x3c\x5a\x1c\x6a\x20\x06\xee\x26",
  "\x86\xad\xa4\xfa\xb2\xbc\xf5\xd0\x64\x18\x97\xe6\xb7\x28\xb1\x3c\xe6\x85"
  "\xde\x59\xf8\x59\xae\xe2\xbc\x15\xca\x0b\xab\x67\x03\xf8\xd1\x99\x1a\x4a"
  "\x60\x33\xe4\x0c\x58\xfb\xc1\x9b\xe5\x3a\x13\x39\x8e\x53\x7b\xf9\x03\xfe"
  "\x19\xea\x0a\xac\x55\xb2\x72\xa8\xa3\x46",
  "\x5b\xe7\x68\x7f\xb7\xd0\xee\x62\xbf\x62\xf0\x6f\xac\x2e\xee\x25\x21\xbe"
  "\x7e\x73\x0c\x1e\xcc\x63\x37\x1f\x5d\x87\x87\xbb\xce\x75",
  "\x28\x5c\xa1\xfe\x69\xb8\xbb\x0a\x7b\x78\x78\x23\xf4\x6c\xcc\x9f\x8e\xc6"
  "\xac\xcf\x8b\xe1\x7e\xaf\x95\xe6\x3c\x4a\x1d\x27\xd4\x69\x9f\x9a\xe9\xb5"
  "\x94\x33\x87\xb5\x76\x27\x6e\x45\x9f\x2d\x57\x92\xcc\x51\xa1\xba\xe1\x32"
  "\x48\xc3\x55\x60\xbf\x21\x1c\xc1\xd7\x81",
  "\x07\x9a\x18\x3f\x31\x2e\x9b\xd4\xd2\x3c\xb9\x97\x54\x80\x28\xb0\x31\x01"
  "\x0e\x80\xbd\x59\xd5\x67\x34\x14\xe4\xeb\xc1\x0d\xd9\x9d",
  "\xe8\x29\x02\xb5\x88\x1d\x6a\x8d\x4d\x42\xc1\x52\xae\x60\xea\x1c\x81\xa6"
  "\xfd\x17\x16\x76\xd1\x6b\x7e\x94\xe4\xa8\x5f\xaf\x46\x28\x79\xc6\x67\x25"
  "\x40\x42\x59\xaf\x44\x13\xc4\x28\xb8\x58\x51\x8e\x46\x74\x78\x8f\xc5\x35"
  "\x6b\xb9\xb6\x00\xf9\x6b\x88\xed\x47\x06",
  "\x0a\x55\xa5\x79\xdc\xcc\x4b\xf1\x1b\x59\xfa\x85\xdb\x6e\x33\xed\xa0\x69"
  "\x25\x72\x06\xfd\x62\x34\x54\x45\xcc\xba\x20\x32\x70\x43",
  "\xf9\x62\x01\xa7\xe0\xdd\x00\xd5\x9b\x9b\x64\xeb\xed\x6a\xc9\xa7\xd5\x10"
  "\x8d\xa0\xaf\xef\xb6\xfa\x86\x90\x59\x14\xa3\x37\x87\x85\x24\x07\x08\xfc"
  "\xf6\x7d\xe0\x48\x1b\x35\x18\xcc\x4a\x8b\xf0\x5f\xfa\x4f\x82\xea\x87\x43"
  "\xdb\x32\x1f\x7d\xaf\x86\x67\x94\xcf\x93",
  "\xc7\x9f\xdb\xd9\xdb\xe4\x94\xbe\x55\x97\xac\xf6\x6c\xc5\x8d\x54\x87\xf0"
  "\x32\xfb\xda\x9a\x73\x70\x28\x3c\x41\x50\x28\xb3\x35\x41",
  "\x76\x68\xfb\x8d\x9b\xc2\x79\xae\xfa\xfc\x0c\x39\xc0\xad\x66\x53\xb9\xbc"
  "\x3d\xd1\x73\x7c\xe1\x9b\x18\x07\x44\x54\x46\x05\xab\x8c\x70\xf4\x61\xac"
  "\xbb\x33\x7d\x68\x6a\xeb\x27\x83\xb5\x03\x63\xff\xfe\xa0\x76\x4d\xe4\x6d"
  "\x1a\x6d\x51\x1c\x5e\xc0\x24\xe5\xa7\x3b",
  "\xad\xad\x3e\x00\x63\xdf\x27\x1a\xbb\x77\xb2\xa0\xd5\x28\x63\x8d\xeb\x4d"
  "\xeb\x5e\xe1\x4d\x00\x25\x3c\x1b\xbe\x7e\x3f\xf9\xb6\xd4",
  "\x4a\x19\xa0\xb8\x97\x52\x43\xa3\xad\x46\xf2\x9a\x2a\x02\x4d\x47\x7b\xca"
  "\xfd\xfb\x50\xf1\x7a\xac\xa5\x66\x00\x39\xfc\xed\x2f\x07\x64\x72\x06\x20"
  "\xdc\xfb\x7c\xcd\x25\x01\xfa\x13\x83\x9f\x79\x87\xbd\x33\x9d\xba\xa2\xeb"
  "\xe5\x1e\x90\x57\x83\x7f\xf5\x10\x38\x0f",
  "\xf8\xf6\x2d\x35\xef\xab\x49\x93\xf8\x99\xeb\xa7\x5e\x02\x19\xc8\x65\x13"
  "\x49\xc9\xe8\xf8\xe7\x46\x77\x9c\xb5\xb1\x20\x3a\x3b\x0d",
  "\x59\x40\x00\x43\x44\xe5\x7a\x3a\x9f\xcc\x53\x31\x34\x38\x07\xdf\xea\x44"
  "\x26\xa8\x61\xe9\xbf\x0e\xcb\x07\xf4\xb4\x75\x72\x58\xff\xee\xf5\x03\x37"
  "\x9d\xe2\x78\xb2\x73\x6e\xf0\x6a\xf1\xf7\x82\x66\xbf\xec\xf1\x14\xd4\x52"
  "\xde\x8a\xfe\x1a\x31\xd3\x5d\x96\x1f\x4a",
  "\x7c\x32\x1c\xc7\xa0\x27\x10\xf4\x2f\x5c\x64\xf7\xd5\x0e\x1c\xca\x13\x9f"
  "\x91\x81\x50\x21\x47\x6c\xb3\xb6\x53\x36\xec\x0a\x8c\x64",
  "\xc8\x60\xe9\xe0\x9b\x4e\x36\x38\x1a\x4d\x8b\x0b\x24\x73\x38\x92\x4a\xa7"
  "\x82\xeb\x79\x60\x3a\x26\x89\x02\x50\xf5\x66\xab\x11\xde\x34\xda\xca\x00"
  "\x56\x40\x3c\x49\xc0\x74\x72\x14\x81\xc2\xc0\xb0\x6c\xb4\x66\x9f\xf9\xa3"
  "\xdf\xbf\xcb\x73\xc6\x22\x80\xe5\x32\xbe",
};

/* this one is intentionally wrong */
static const char *drbg_ctr_vec_fails[] = {
  "\x7c\x32\x1c\xc7\xa0\x27\x10\xf4\x2f\x5c\x64\xf7\xd5\x0e\x1c\xca\x13\x9f"
  "\x91\x81\x50\x21\x47\x6c\xb3\xb6\x53\x36\xec\x0a\x8c\x64",
  "\xc8\x60\xe9\xe0\x9b\x4e\x36\x38\x1a\x4d\x8b\x0b\x24\x73\x38\x92\x4a\xa7"
  "\x82\xeb\x79\x60\x3a\x26\x89\x02\x50\xf5\x66\xab\x11\xde\x34\xda\xca\x00"
  "\x56\x40\x3c\x49\xc0\x74\x72\x14\x81\xc2\xc0\xb0\x6c\xb4\x66\x9f\xf9\xa3"
  "\xdf\xbf\xcb\x73\xc6\x22\x80\xe5\x32\xbf",
};

static int
crypto_test_drbg_ctr1 (vlib_main_t *vm, const char *seed, const char *expected)
{
  vnet_crypto_drbg_ctr_seed_t seed_;
  vnet_crypto_drbg_ctr_t drbg;
  u8 buf[64];
  int ret;

  clib_memcpy_fast (&seed_, seed, sizeof (seed_));
  vnet_crypto_drbg_ctr_init (vm, &drbg, &seed_);

  vnet_crypto_drbg_ctr_generate (vm, &drbg, buf, sizeof (buf));
  vnet_crypto_drbg_ctr_generate (vm, &drbg, buf, sizeof (buf));

  ret = clib_memcmp (expected, buf, sizeof (buf));
  vnet_crypto_drbg_ctr_cleanup (vm, &drbg);
  return ret;
}

clib_error_t *
crypto_test_drbg_ctr (vlib_main_t *vm)
{
  int i;

  for (i = 0; i < ARRAY_LEN (drbg_ctr_vec); i += 2)
    {
      if (crypto_test_drbg_ctr1 (vm, drbg_ctr_vec[i + 0], drbg_ctr_vec[i + 1]))
	return clib_error_return (0, "validation test %d failed\n", i / 2);
    }

  if (!crypto_test_drbg_ctr1 (vm, drbg_ctr_vec_fails[0],
			      drbg_ctr_vec_fails[1]))
    return clib_error_return (0, "failure test failed\n");

  vlib_cli_output (vm, "test crypto drbg: success");
  return 0;
}

clib_error_t *
crypto_test_drbg_ctr_perf (vlib_main_t *vm, const crypto_test_main_t *tm)
{
  const u32 rounds = tm->rounds ? tm->rounds : 256;
  const u32 warmup_rounds = tm->warmup_rounds ? tm->warmup_rounds : 100;
  const u32 buffer_size = tm->buffer_size ? tm->buffer_size : 16;
  u8 *buf;
  int i;

  buf = clib_mem_alloc (buffer_size);

  for (i = 0; i < warmup_rounds; i++)
    vnet_crypto_rand (vm, buf, buffer_size);

  u64 start = clib_cpu_time_now ();
  for (i = 0; i < rounds; i++)
    vnet_crypto_rand (vm, buf, buffer_size);
  u64 stop = clib_cpu_time_now ();
  vlib_cli_output (vm, "%f ticks/round", (f64) (stop - start) / rounds);

  clib_mem_free (buf);
  return 0;
}

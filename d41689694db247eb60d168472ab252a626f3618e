{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "b13311c2_444c187e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1854
      },
      "writtenOn": "2022-11-18T09:27:08Z",
      "side": 1,
      "message": "Backtrace of all threads from original issue:\nThread 1 \"vpp_main\" received signal SIGABRT, Aborted.\n__GI_raise (sig\u003dsig@entry\u003d6) at ../sysdeps/unix/sysv/linux/raise.c:50\n50      ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) thread apply all bt\n\nThread 6 (Thread 0x7ffe72a7e700 (LWP 2200824)):\n#0  0x00007ffff6df2de5 in adj_glean_get_src (proto\u003d\u003coptimized out\u003e, sw_if_index\u003d\u003coptimized out\u003e, nh\u003d0x7ffe72a7dbc0) at /root/vpp/src/vnet/adj/adj_glean.c:279\n#1  0x00007ffff6dea8a9 in fib_sas4_get (sw_if_index\u003d1, dst\u003d\u003coptimized out\u003e, src\u003d0x7ffe72a7dc38) at /root/vpp/src/vnet/fib/fib_sas.c:87\n#2  0x00007ffff696b00b in ip4_arp_inline (vm\u003d\u003coptimized out\u003e, node\u003d0x7fff19e23880, frame\u003d\u003coptimized out\u003e, is_glean\u003d0) at /root/vpp/src/vnet/ip-neighbor/ip4_neighbor.c:197\n#3  ip4_arp_node_fn (vm\u003d\u003coptimized out\u003e, node\u003d0x7fff19e23880, frame\u003d0x7fff3fd9b340) at /root/vpp/src/vnet/ip-neighbor/ip4_neighbor.c:264\n#4  0x00007ffff63486fb in dispatch_node (vm\u003d0x7ffefccb8500, node\u003d0x7fff19e23880, type\u003dVLIB_NODE_TYPE_INTERNAL, dispatch_state\u003dVLIB_NODE_STATE_POLLING, frame\u003d\u003coptimized out\u003e, last_time_stamp\u003d2780803894412442) at /root/vpp/src/vlib/main.c:960\n#5  dispatch_pending_node (vm\u003d0x7ffefccb8500, pending_frame_index\u003d3, last_time_stamp\u003d2780803894412442) at /root/vpp/src/vlib/main.c:1119\n#6  vlib_main_or_worker_loop (vm\u003d0x7ffefccb8500, is_main\u003d0) at /root/vpp/src/vlib/main.c:1588\n#7  vlib_worker_loop (vm\u003d0x7ffefccb8500) at /root/vpp/src/vlib/main.c:1722\n#8  0x00007ffff639aafa in vlib_worker_thread_fn (arg\u003d0x7ffef64bd200) at /root/vpp/src/vlib/threads.c:1598\n#9  0x00007ffff6394e01 in vlib_worker_thread_bootstrap_fn (arg\u003d0x7ffef64bd200) at /root/vpp/src/vlib/threads.c:418\n#10 0x00007ffff62c3609 in start_thread (arg\u003d\u003coptimized out\u003e) at pthread_create.c:477\n#11 0x00007ffff6001293 in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\n\nThread 5 (Thread 0x7ffe72c7f700 (LWP 2200823)):\n#0  0x00007ffff6df2de5 in adj_glean_get_src (proto\u003d\u003coptimized out\u003e, sw_if_index\u003d\u003coptimized out\u003e, nh\u003d0x7ffe72c7ebc0) at /root/vpp/src/vnet/adj/adj_glean.c:279\n#1  0x00007ffff6dea8a9 in fib_sas4_get (sw_if_index\u003d1, dst\u003d\u003coptimized out\u003e, src\u003d0x7ffe72c7ec38) at /root/vpp/src/vnet/fib/fib_sas.c:87\n#2  0x00007ffff696b00b in ip4_arp_inline (vm\u003d\u003coptimized out\u003e, node\u003d0x7fff19e0c280, frame\u003d\u003coptimized out\u003e, is_glean\u003d0) at /root/vpp/src/vnet/ip-neighbor/ip4_neighbor.c:197\n#3  ip4_arp_node_fn (vm\u003d\u003coptimized out\u003e, node\u003d0x7fff19e0c280, frame\u003d0x7fff3fd96280) at /root/vpp/src/vnet/ip-neighbor/ip4_neighbor.c:264\n#4  0x00007ffff63486fb in dispatch_node (vm\u003d0x7ffefcc84d40, node\u003d0x7fff19e0c280, type\u003dVLIB_NODE_TYPE_INTERNAL, dispatch_state\u003dVLIB_NODE_STATE_POLLING, frame\u003d\u003coptimized out\u003e, last_time_stamp\u003d2780803894401820) at /root/vpp/src/vlib/main.c:960\n#5  dispatch_pending_node (vm\u003d0x7ffefcc84d40, pending_frame_index\u003d7, last_time_stamp\u003d2780803894401820) at /root/vpp/src/vlib/main.c:1119\n#6  vlib_main_or_worker_loop (vm\u003d0x7ffefcc84d40, is_main\u003d0) at /root/vpp/src/vlib/main.c:1588\n#7  vlib_worker_loop (vm\u003d0x7ffefcc84d40) at /root/vpp/src/vlib/main.c:1722\n#8  0x00007ffff639aafa in vlib_worker_thread_fn (arg\u003d0x7ffef64bd100) at /root/vpp/src/vlib/threads.c:1598\n#9  0x00007ffff6394e01 in vlib_worker_thread_bootstrap_fn (arg\u003d0x7ffef64bd100) at /root/vpp/src/vlib/threads.c:418\n#10 0x00007ffff62c3609 in start_thread (arg\u003d\u003coptimized out\u003e) at pthread_create.c:477\n#11 0x00007ffff6001293 in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\n\nThread 4 (Thread 0x7ffe72e80700 (LWP 2200822)):\n#0  0x00007ffff6df2d66 in adj_glean_get_src (proto\u003d\u003coptimized out\u003e, sw_if_index\u003d\u003coptimized out\u003e, nh\u003d0x7ffe72e7fbc0) at /root/vpp/src/vnet/adj/adj_glean.c:279\n#1  0x00007ffff6dea8a9 in fib_sas4_get (sw_if_index\u003d1, dst\u003d\u003coptimized out\u003e, src\u003d0x7ffe72e7fc38) at /root/vpp/src/vnet/fib/fib_sas.c:87\n#2  0x00007ffff696b00b in ip4_arp_inline (vm\u003d\u003coptimized out\u003e, node\u003d0x7fff19e00780, frame\u003d\u003coptimized out\u003e, is_glean\u003d0) at /root/vpp/src/vnet/ip-neighbor/ip4_neighbor.c:197\n#3  ip4_arp_node_fn (vm\u003d\u003coptimized out\u003e, node\u003d0x7fff19e00780, frame\u003d0x7fff3fd97040) at /root/vpp/src/vnet/ip-neighbor/ip4_neighbor.c:264\n#4  0x00007ffff63486fb in dispatch_node (vm\u003d0x7ffefcc516c0, node\u003d0x7fff19e00780, type\u003dVLIB_NODE_TYPE_INTERNAL, dispatch_state\u003dVLIB_NODE_STATE_POLLING, frame\u003d\u003coptimized out\u003e, last_time_stamp\u003d2780803894390850) at /root/vpp/src/vlib/main.c:960\n#5  dispatch_pending_node (vm\u003d0x7ffefcc516c0, pending_frame_index\u003d3, last_time_stamp\u003d2780803894390850) at /root/vpp/src/vlib/main.c:1119\n--Type \u003cRET\u003e for more, q to quit, c to continue without paging--\n#6  vlib_main_or_worker_loop (vm\u003d0x7ffefcc516c0, is_main\u003d0) at /root/vpp/src/vlib/main.c:1588\n#7  vlib_worker_loop (vm\u003d0x7ffefcc516c0) at /root/vpp/src/vlib/main.c:1722\n#8  0x00007ffff639aafa in vlib_worker_thread_fn (arg\u003d0x7ffef64bd000) at /root/vpp/src/vlib/threads.c:1598\n#9  0x00007ffff6394e01 in vlib_worker_thread_bootstrap_fn (arg\u003d0x7ffef64bd000) at /root/vpp/src/vlib/threads.c:418\n#10 0x00007ffff62c3609 in start_thread (arg\u003d\u003coptimized out\u003e) at pthread_create.c:477\n#11 0x00007ffff6001293 in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\n\nThread 3 (Thread 0x7ffe73081700 (LWP 2200821)):\n#0  vlib_worker_thread_barrier_check () at /root/vpp/src/vlib/threads.h:388\n#1  vlib_main_or_worker_loop (vm\u003d0x7ffefcc1e340, is_main\u003d0) at /root/vpp/src/vlib/main.c:1516\n#2  vlib_worker_loop (vm\u003d0x7ffefcc1e340) at /root/vpp/src/vlib/main.c:1722\n#3  0x00007ffff639aafa in vlib_worker_thread_fn (arg\u003d0x7ffef64bcf00) at /root/vpp/src/vlib/threads.c:1598\n#4  0x00007ffff6394e01 in vlib_worker_thread_bootstrap_fn (arg\u003d0x7ffef64bcf00) at /root/vpp/src/vlib/threads.c:418\n#5  0x00007ffff62c3609 in start_thread (arg\u003d\u003coptimized out\u003e) at pthread_create.c:477\n#6  0x00007ffff6001293 in clone () at ../sysdeps/unix/sysv/linu pthread_create :95\n\nThread 2 (Thread 0x7ffe738c3700 (LWP 2200818)):\n#0  0x00007ffff60015ce in epoll_wait (epfd\u003d13, events\u003d0x7ffe738c2da0, maxevents\u003d5, timeout\u003d-1) at ../sysdeps/unix/sysv/linux/epoll_wait.c:30\n#1  0x00007ffef40670d4 in eal_intr_thread_main () from /root/vpp/build-root/install-vpp-native/vpp/lib/x86_64-linux-gnu/vpp_plugins/dpdk_plugin.so\n#2  0x00007ffff62c3609 in start_thread (arg\u003d\u003coptimized out\u003e) at pthread_create.c:477\n#3  0x00007ffff6001293 in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\n\nThread 1 (Thread 0x7ffff5eddc40 (LWP 2200770)):\n#0  __GI_raise (sig\u003dsig@entry\u003d6) at ../sysdeps/unix/sysv/linux/raise.c:50\n#1  0x00007ffff5f04859 in __GI_abort () at abort.c:79\n#2  0x00000000004058d0 in os_panic () at /root/vpp/src/vpp/vnet/main.c:417\n#3  0x00007ffff6399e68 in vlib_worker_thread_barrier_sync_int (vm\u003d0x7ffef5e00700, func_name\u003d\u003coptimized out\u003e) at /root/vpp/src/vlib/threads.c:1370\n#4  0x000000000040593f in vl_msg_api_barrier_sync () at /root/vpp/src/vpp/vnet/main.c:457\n#5  0x00007ffff7fa5fa9 in vl_mem_api_handle_rpc (vm\u003d0x7ffef5e00700, node\u003d0x7ffef7952300) at /root/vpp/src/vlibmemory/memory_api.c:956\n#6  0x00007ffff7fadddb in vl_api_clnt_process (vm\u003d\u003coptimized out\u003e, node\u003d\u003coptimized out\u003e, f\u003d\u003coptimized out\u003e) at /root/vpp/src/vlibmemory/memclnt_api.c:358\n#7  0x00007ffff634e837 in vlib_process_bootstrap (_a\u003d\u003coptimized out\u003e) at /root/vpp/src/vlib/main.c:1221\n#8  0x00007ffff629ed34 in clib_calljmp () at /root/vpp/src/vppinfra/longjmp.S:123\n#9  0x00007ffef3cf1d60 in ?? ()\n#10 0x00007ffff63463d0 in vlib_process_startup (vm\u003d0x7ffef5e00700, p\u003d0x7ffef7952300, f\u003d0x0) at /root/vpp/src/vlib/main.c:1246\n#11 dispatch_process (vm\u003d0x7ffef5e00700, p\u003d0x7ffef7952300, f\u003d0x0, last_time_stamp\u003d\u003coptimized out\u003e) at /root/vpp/src/vlib/main.c:1302\n#12 0x0000000000000000 in ?? ()\n(gdb)",
      "revId": "d41689694db247eb60d168472ab252a626f3618e",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1319f388_843c83a3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1854
      },
      "writtenOn": "2022-11-18T10:53:24Z",
      "side": 1,
      "message": "This cod in adj_glean.c is not thread safe and needs synchronization:\n\n  279     hash_foreach_mem(conn, ai, adj_gleans[proto][sw_if_index],\n  280     ({\n  281         adj \u003d adj_get(ai);\n  282\n  283         if (adj-\u003esub_type.glean.rx_pfx.fp_len \u003e 0)\n  284         {\n  285             source \u003d \u0026adj-\u003esub_type.glean.rx_pfx.fp_addr;\n  286\n  287             /* if no destination is specified use the just glean */\n  288             if (NULL \u003d\u003d nh)\n  289                 return (source);\n  290\n  291             /* check the clean covers the desintation */\n  292             if (fib_prefix_is_cover(\u0026adj-\u003esub_type.glean.rx_pfx, \u0026pfx))\n  293                 return (source);\n  294         }\n  295     }));\n",
      "revId": "d41689694db247eb60d168472ab252a626f3618e",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    }
  ]
}
{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "2d89685f_62d242ac",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 2465
      },
      "writtenOn": "2022-06-15T13:26:23Z",
      "side": 1,
      "message": "Now we have the \u003cfast path\u003e suffix available in \u0027show ipsec spd\u0027 output, would it be possible to check for this suffix after adding each policy that we expect to be added to fast path?\n\nI\u0027m still not 100% clear on what policies are able to be added to fast path, and what kinds of policies are not supported (as per my comment at https://gerrit.fd.io/r/c/vpp/+/36096/comments/cf01d91b_82de3d59).",
      "revId": "c85e8c2a28472e9605e41bf282945cbb5465b54e",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d4be813a_600c63a1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1849
      },
      "writtenOn": "2022-06-16T08:53:03Z",
      "side": 1,
      "message": "Hi Zach,\n\nIn short in the latest patch all flows can be added to fast path. I believe it is better Piotr to explain the details. He is on holiday and will be back next Monday.\n\nBefore the change we thought of adding a new API to check if fast path is enabled for a policy - apparently after the change it is not needed anymore. Do you still think it is necessary?\n\nRegards,\nFan",
      "parentUuid": "2d89685f_62d242ac",
      "revId": "c85e8c2a28472e9605e41bf282945cbb5465b54e",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2d982072_20b04e6b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1854
      },
      "writtenOn": "2022-06-20T14:12:56Z",
      "side": 1,
      "message": "Hi Zachary, Fan is correct. Now this suffix doesn\u0027t make much sense as when fast path is enabled every policy is added to fast path spd. First of all we\u0027ve found with Fan that it is not possible to have a split between fast path policies and slow path at same time without extra steps. We need either assumption that such policies do not overlap (and when I thought about it I don\u0027t think we have efficient way to do it - we would have to fragment policies into small ranges - tracking down how it was done, and removing such fragmented policies, when deleting a policy would be a nightmare) or we cannot have it in place. Imagine policy with specific ip addresses and ports that has been added to fast path with low priority and a policy that covers all ip addresses which has been added to slow path, but with higher priority. Because of overlap packet with ip addresses specified by fp policy will be matched to it and slow path policy would not be applied - which is not correct behavior. So when we\u0027ve realized this assumption doesn\u0027t hold we are using masking that always works: we mask out all bits of ip address starting from first that may change (see comment in function calculating 5touple mask). Price for this is that distribution of policies between keys is now even less homogenous than before, however scenarios with a lot of policies covering small ranges of ip addresses and ports are still robust - and that is the target for fast path matching.",
      "parentUuid": "d4be813a_600c63a1",
      "revId": "c85e8c2a28472e9605e41bf282945cbb5465b54e",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    }
  ]
}
{
  "comments": [
    {
      "key": {
        "uuid": "b5dc3e70_54be3e2d",
        "filename": "src/svm/svm_fifo.c",
        "patchSetId": 39
      },
      "lineNbr": 833,
      "author": {
        "id": 1561
      },
      "writtenOn": "2020-01-13T14:15:27Z",
      "side": 1,
      "message": "This is trying to allocate as many chunks as possible to fill the allowance (f-\u003esize).\nI guess `clib_min (len, alloc_size)` should be the correct size to add, where len denotes the size of space to be added.",
      "revId": "beafe95779b291c11b0ff98f74990aaa4f088a9c",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "009d1eb7_d1668bea",
        "filename": "src/svm/svm_fifo.c",
        "patchSetId": 39
      },
      "lineNbr": 833,
      "author": {
        "id": 193
      },
      "writtenOn": "2020-01-13T15:40:37Z",
      "side": 1,
      "message": "alloc_size is the \"size of the chunk(s) to be added\", i.e., len from your comment. So did I miss something wrt your comment?",
      "parentUuid": "b5dc3e70_54be3e2d",
      "revId": "beafe95779b291c11b0ff98f74990aaa4f088a9c",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f8570621_641880b7",
        "filename": "src/svm/svm_fifo.c",
        "patchSetId": 39
      },
      "lineNbr": 833,
      "author": {
        "id": 1561
      },
      "writtenOn": "2020-01-13T15:50:34Z",
      "side": 1,
      "message": "For example assume...\n  f-\u003esize \u003d 2MB,\n  f_cur_size (...) \u003d 16KB,\n  free_allocated \u003d 1KB,\nthen alloc_size \u003d (2MB - 16KB - 1KB).\nAfter calling fsh_alloc_chunk() with this alloc_size, I guess the actual fifo size becomes almost same as the virtual fifo size. Isn\u0027t it?",
      "parentUuid": "009d1eb7_d1668bea",
      "revId": "beafe95779b291c11b0ff98f74990aaa4f088a9c",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7d1ea968_16732df6",
        "filename": "src/svm/svm_fifo.c",
        "patchSetId": 39
      },
      "lineNbr": 833,
      "author": {
        "id": 193
      },
      "writtenOn": "2020-01-13T18:01:43Z",
      "side": 1,
      "message": "free_allocated \u003d f-\u003esize - 16kB (cursize) - (end_chunk_last_byte - tail). \n\nAssuming end_chunk_last_byte \u003d 2MB and tail \u003d 2MB - 1KB, then the numbers are the ones above, i.e., alloc_size \u003d 2MB - 16kB - 1kB.\n\nTherefore, the next allocated chunk will be 2MB (rounded to power-of-2) and out of it only alloc_size will be available for writing. f-\u003esize does not change and it is similar to the virtual fifo size we’ve discussed over email. The one important difference is that it’s not a cap on the maximum amount of memory allocated for a fifo. In the example above, 2MB - 17kB at the beginning of the first chunk are not usable but allocated. However, this example should be the exception because fifos should not be this underutilized (0.08%). With better utilization, fifo chunks should be more and smaller in size. Therefore the error should be lower.",
      "parentUuid": "f8570621_641880b7",
      "revId": "beafe95779b291c11b0ff98f74990aaa4f088a9c",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "14931545_bd024524",
        "filename": "src/svm/svm_fifo.c",
        "patchSetId": 39
      },
      "lineNbr": 833,
      "author": {
        "id": 1561
      },
      "writtenOn": "2020-01-13T20:01:32Z",
      "side": 1,
      "message": "Hi Florin,\nMaybe I\u0027m wrong, but I thought the free_alloced given by \n  free_alloced \u003d f_chunk_end (f-\u003eend_chunk) - tail;\nseems to have different meaning.",
      "parentUuid": "7d1ea968_16732df6",
      "revId": "beafe95779b291c11b0ff98f74990aaa4f088a9c",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33029146_6f919e91",
        "filename": "src/svm/svm_fifo.c",
        "patchSetId": 39
      },
      "lineNbr": 833,
      "author": {
        "id": 193
      },
      "writtenOn": "2020-01-13T21:37:22Z",
      "side": 1,
      "message": "Apologies, the first \"free_allocated\" should\u0027ve been \"alloc_size\". \n\nThe point I was trying to make there was with respect to how \"free_allocated\" could be 1kB. That is, for it to be 1kB one possibility would be for f_chunk_end (end_chunk) to be 2MB and tail to be 2MB - 1kB.",
      "parentUuid": "14931545_bd024524",
      "revId": "beafe95779b291c11b0ff98f74990aaa4f088a9c",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    }
  ]
}
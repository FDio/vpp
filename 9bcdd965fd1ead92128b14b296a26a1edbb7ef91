{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f11f6f68_f522b404",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 2220
      },
      "writtenOn": "2025-06-17T10:23:29Z",
      "side": 1,
      "message": "Hello Matthew,\nCould you please review this patch? It covers 2 things:\n1) fixes locking/unlocking table\n2) when there\u0027s a replace w/o paths (e.g. blackhole) - we need to remove entry from fib (and unlock table)",
      "revId": "9bcdd965fd1ead92128b14b296a26a1edbb7ef91",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1f2283cc_5e12e9af",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 366
      },
      "writtenOn": "2025-06-26T20:28:10Z",
      "side": 1,
      "message": "Hi Stanislav,\nI added a comment and some questions.",
      "revId": "9bcdd965fd1ead92128b14b296a26a1edbb7ef91",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "02387c3f_cf3bebf6",
        "filename": "src/plugins/linux-cp/lcp_router.c",
        "patchSetId": 2
      },
      "lineNbr": 1360,
      "author": {
        "id": 366
      },
      "writtenOn": "2025-06-26T20:28:10Z",
      "side": 1,
      "message": "It seems like you move this inside the `if (0 !\u003d vec_len (np.paths))` block and then avoid the unlock in the \u0027else\u0027 block. The unlock seems like it only undoes the lock that is done here.",
      "revId": "9bcdd965fd1ead92128b14b296a26a1edbb7ef91",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4af89602_bc16e090",
        "filename": "src/plugins/linux-cp/lcp_router.c",
        "patchSetId": 2
      },
      "lineNbr": 1360,
      "author": {
        "id": 2220
      },
      "writtenOn": "2025-07-04T12:01:07Z",
      "side": 1,
      "message": "nice catch, thank you!",
      "parentUuid": "02387c3f_cf3bebf6",
      "revId": "9bcdd965fd1ead92128b14b296a26a1edbb7ef91",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "237bd368_e24823f2",
        "filename": "src/plugins/linux-cp/lcp_router.c",
        "patchSetId": 2
      },
      "lineNbr": 1429,
      "author": {
        "id": 366
      },
      "writtenOn": "2025-06-26T20:28:10Z",
      "side": 1,
      "message": "Is deleting the FIB entry the right thing to do if a route with no paths is added in the kernel table? I\u0027m not sure under what conditions that would actually happen. You mentioned blackhole routes in your note, but blackhole routes get a path added by lcp_router_route_path_add_special() and end up being handled by the \u0027if\u0027 block and added to VPP\u0027s FIB as drop routes.\n\nHave you observed a case where the else block is reached? It\u0027s possible that deleting the entry is the right choice here, but I am not sure without knowing what conditions this actually happens under.",
      "revId": "9bcdd965fd1ead92128b14b296a26a1edbb7ef91",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6e38d6ba_fa509a1b",
        "filename": "src/plugins/linux-cp/lcp_router.c",
        "patchSetId": 2
      },
      "lineNbr": 1429,
      "author": {
        "id": 2220
      },
      "writtenOn": "2025-07-04T12:01:07Z",
      "side": 1,
      "message": "OK, it seems I\u0027ve finally recalled what exactly happened in my case.\n\nSomebody added a TAP interface to lcp dataplane netns and some routes were replaced from LCP interface to this TAP interface (therefore no valid nexthops in lcp plugin). Then the TAP was destroyed but stale entries were still in vpp fib.\n\nEasy way to reproduce:\n- create dummy interface in LCP netns\n- add a route via LCP interface\n- replace the route via dummy interface\n- the fib entry is still there\n\nI understand that it shouldn\u0027t have happened in the first place, but people (including myself) do stupid things :)\n\nAnyway, I rely on your opinion, if you think we should remove this \"fix\", I\u0027ll do that.",
      "parentUuid": "237bd368_e24823f2",
      "revId": "9bcdd965fd1ead92128b14b296a26a1edbb7ef91",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0070ce6b_ab741acb",
        "filename": "src/plugins/linux-cp/lcp_router.c",
        "patchSetId": 2
      },
      "lineNbr": 1429,
      "author": {
        "id": 366
      },
      "writtenOn": "2025-07-08T12:50:14Z",
      "side": 1,
      "message": "Ok, that seems fine. Thanks for explaining. I have never seen the \"no paths for route\" message logged on a running system so I just wanted to make sure I understand what is happening when this condition arises.",
      "parentUuid": "6e38d6ba_fa509a1b",
      "revId": "9bcdd965fd1ead92128b14b296a26a1edbb7ef91",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    }
  ]
}
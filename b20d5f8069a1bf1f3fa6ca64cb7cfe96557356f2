{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "1511437f_a371e176",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 3161
      },
      "writtenOn": "2025-12-03T12:45:15Z",
      "side": 1,
      "message": "recheck",
      "revId": "b20d5f8069a1bf1f3fa6ca64cb7cfe96557356f2",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2f44c4f3_53e71a7d",
        "filename": "src/plugins/hs_apps/vcl/vcl_test_server.c",
        "patchSetId": 2
      },
      "lineNbr": 739,
      "author": {
        "id": 123
      },
      "writtenOn": "2025-12-04T15:25:53Z",
      "side": 1,
      "message": "I think this need to be like stop message on control session, for example test type can be HS_TEST_TYPE_EXIT so we need to stop server too",
      "revId": "b20d5f8069a1bf1f3fa6ca64cb7cfe96557356f2",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "17db0587_e7e0989a",
        "filename": "src/plugins/hs_apps/vcl/vcl_test_server.c",
        "patchSetId": 2
      },
      "lineNbr": 739,
      "author": {
        "id": 3161
      },
      "writtenOn": "2025-12-04T17:05:07Z",
      "side": 1,
      "message": "I don\u0027t understand. In this scenario we have no control session, but something connects to the open data port.",
      "parentUuid": "2f44c4f3_53e71a7d",
      "revId": "b20d5f8069a1bf1f3fa6ca64cb7cfe96557356f2",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0b955a51_18a206e6",
        "filename": "src/plugins/hs_apps/vcl/vcl_test_server.c",
        "patchSetId": 2
      },
      "lineNbr": 739,
      "author": {
        "id": 123
      },
      "writtenOn": "2025-12-04T17:21:51Z",
      "side": 1,
      "message": "I hit scenario where we have disconnects during test that force ctrl to be closed\nor ctrl goes away before data, so if test is running we should not ignore this state",
      "parentUuid": "17db0587_e7e0989a",
      "revId": "b20d5f8069a1bf1f3fa6ca64cb7cfe96557356f2",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bc22364e_2b28c3e7",
        "filename": "src/plugins/hs_apps/vcl/vcl_test_server.c",
        "patchSetId": 2
      },
      "lineNbr": 739,
      "author": {
        "id": 3161
      },
      "writtenOn": "2025-12-09T17:42:07Z",
      "side": 1,
      "message": "If ctrl goes away, we have no knowledge of test state as it is stored inside vsm-\u003ectrl.cfg.\nAt this point, the test is failed and stopped. Any dangling connections should be cleared.",
      "parentUuid": "0b955a51_18a206e6",
      "revId": "b20d5f8069a1bf1f3fa6ca64cb7cfe96557356f2",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1d8374e7_170784fe",
        "filename": "src/plugins/hs_apps/vcl/vcl_test_server.c",
        "patchSetId": 2
      },
      "lineNbr": 739,
      "author": {
        "id": 193
      },
      "writtenOn": "2025-12-09T22:24:51Z",
      "side": 1,
      "message": "Test should fail and sessions should be cleaned up on line 714. We should break the loop so the ASSERT on this line could theoretically stay here if we make sure that any read/write error on the control session aborts the test.\n\nIf we can\u0027t do that we should just avoid processing any events, i.e., just continue (no logging, because there could be lots of events), assuming that at the end of event processing loop we\u0027ll exit the test.",
      "parentUuid": "bc22364e_2b28c3e7",
      "revId": "b20d5f8069a1bf1f3fa6ca64cb7cfe96557356f2",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "57e9c008_fe70e253",
        "filename": "src/plugins/hs_apps/vcl/vcl_test_server.c",
        "patchSetId": 2
      },
      "lineNbr": 739,
      "author": {
        "id": 3161
      },
      "writtenOn": "2025-12-10T14:17:39Z",
      "side": 1,
      "message": "Regarding the 2nd paragraph, I don\u0027t think we can avoid the worker evt processing loop entirely, as it\u0027s also responsible for accepting new ctrl sessions.\nRight now (assuming the test is stopped) we can receive an event, check if it\u0027s a new ctrl session or just a bogus data packet and await more events.",
      "parentUuid": "1d8374e7_170784fe",
      "revId": "b20d5f8069a1bf1f3fa6ca64cb7cfe96557356f2",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a0cf3eac_92a77b8e",
        "filename": "src/plugins/hs_apps/vcl/vcl_test_server.c",
        "patchSetId": 2
      },
      "lineNbr": 739,
      "author": {
        "id": 193
      },
      "writtenOn": "2025-12-12T00:20:21Z",
      "side": 1,
      "message": "The accept is on line 728. Tests were mostly fine asserting that by this point we had a ctrl session, hope is that with a bit more logic we can either remove the assert (maybe 714 is what we were missing) or ignore events when there\u0027s no control session and continue.",
      "parentUuid": "57e9c008_fe70e253",
      "revId": "b20d5f8069a1bf1f3fa6ca64cb7cfe96557356f2",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "90eea859_fc43941c",
        "filename": "src/plugins/hs_apps/vcl/vcl_test_server.c",
        "patchSetId": 2
      },
      "lineNbr": 739,
      "author": {
        "id": 3161
      },
      "writtenOn": "2025-12-12T15:07:32Z",
      "side": 1,
      "message": "So kind of how it is right now? We\u0027re cleaning everything up on ctrl session disconnect on 714 and then listen for new ctrl session connections, otherwise skipping the event on 740.\n746 path was added just for redundancy\u0027s sake, but we might get rid of it.",
      "parentUuid": "a0cf3eac_92a77b8e",
      "revId": "b20d5f8069a1bf1f3fa6ca64cb7cfe96557356f2",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2"
    }
  ]
}
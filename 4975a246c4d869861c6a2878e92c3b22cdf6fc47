{
  "comments": [
    {
      "key": {
        "uuid": "734deb2c_65da84e2",
        "filename": "src/plugins/unittest/ipsec_test.c",
        "patchSetId": 2
      },
      "lineNbr": 63,
      "author": {
        "id": 2465
      },
      "writtenOn": "2022-05-16T17:14:19Z",
      "side": 1,
      "message": "This is only testing the linear search right? What is this testing that the perf test with flow cache/fast path disabled is not?",
      "revId": "4975a246c4d869861c6a2878e92c3b22cdf6fc47",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0497545a_74f3a248",
        "filename": "src/plugins/unittest/ipsec_test.c",
        "patchSetId": 2
      },
      "lineNbr": 63,
      "author": {
        "id": 1854
      },
      "writtenOn": "2022-05-18T09:35:27Z",
      "side": 1,
      "message": "Depending on startup.conf settings (ipv4-outbound-spd-fp on/off ipv4-outbound-spd-flow-cache on/off) this function tests linear search, flow cache, fast path, fast path + flow cache.",
      "parentUuid": "734deb2c_65da84e2",
      "revId": "4975a246c4d869861c6a2878e92c3b22cdf6fc47",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7b1a6b9a_fd6566d5",
        "filename": "src/plugins/unittest/ipsec_test.c",
        "patchSetId": 2
      },
      "lineNbr": 63,
      "author": {
        "id": 2465
      },
      "writtenOn": "2022-05-18T13:29:25Z",
      "side": 1,
      "message": "This test only calls `ipsec_output_policy_match` which does fp + linear search, so I\u0027m not sure that it tests flow cache here? \n\nI originally missed the changes in ipsec_output_policy_match since it\u0027s moved files + those changes didn\u0027t show up in the diff. A separate commit moving the functions before making any fast path changes would be better.\n\nIn any case, does the perf test not test the above, seems like this a possible duplicate test that is covered by the perf test anyway.",
      "parentUuid": "0497545a_74f3a248",
      "revId": "4975a246c4d869861c6a2878e92c3b22cdf6fc47",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cdb2cd95_d8fc5e4f",
        "filename": "src/plugins/unittest/ipsec_test.c",
        "patchSetId": 2
      },
      "lineNbr": 63,
      "author": {
        "id": 1849
      },
      "writtenOn": "2022-05-18T14:16:19Z",
      "side": 1,
      "message": "Hi Leaf,\n\nI would say let\u0027s remove the functional test completely? We don\u0027t need it at all.\nMy original intention was to remove perf test as well - but seems you liked the idea?\n\nRegards,\nFan",
      "parentUuid": "7b1a6b9a_fd6566d5",
      "revId": "4975a246c4d869861c6a2878e92c3b22cdf6fc47",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5dbbe142_9fea2401",
        "filename": "src/plugins/unittest/ipsec_test.c",
        "patchSetId": 2
      },
      "lineNbr": 63,
      "author": {
        "id": 2465
      },
      "writtenOn": "2022-05-18T14:59:00Z",
      "side": 1,
      "message": "Hi Fan,\n\nI\u0027m okay with either - keeping only perf test or removing both tests. The perf test isn\u0027t really setup to show benefits of flow cache (every flow is different), but I think it does demonstrate benefit of fast path quite nicely.",
      "parentUuid": "cdb2cd95_d8fc5e4f",
      "revId": "4975a246c4d869861c6a2878e92c3b22cdf6fc47",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f472a02d_8be65a46",
        "filename": "src/plugins/unittest/ipsec_test.c",
        "patchSetId": 2
      },
      "lineNbr": 63,
      "author": {
        "id": 1854
      },
      "writtenOn": "2022-05-18T23:18:20Z",
      "side": 1,
      "message": "Sorry my previous comment was abouttest_ipsec_spd_outbound_perf_command_fn. This test is more like sanity test, checking if add/delete and matching functionality is not broken. As Fan suggested it may be removed. It has been useful for development phase.",
      "parentUuid": "5dbbe142_9fea2401",
      "revId": "4975a246c4d869861c6a2878e92c3b22cdf6fc47",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9a73e2f4_77ca4e37",
        "filename": "src/plugins/unittest/ipsec_test.c",
        "patchSetId": 2
      },
      "lineNbr": 63,
      "author": {
        "id": 1849
      },
      "writtenOn": "2022-05-19T08:06:47Z",
      "side": 1,
      "message": "Hi Leaf,\n\nThe perf test has a \"warming up\" section that looking up all flows prior to the test starts. This benefits flow cache more than other use cases as this allows the flow cache table are filled and, if the flow entries is smaller than bucket size, resulting in ~100% hit rate in the perf collection time. Actually due to the same reason flow cache maybe slightly faster than fast path when bucket size is very big.",
      "parentUuid": "f472a02d_8be65a46",
      "revId": "4975a246c4d869861c6a2878e92c3b22cdf6fc47",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c3d234a0_824a3ecb",
        "filename": "src/plugins/unittest/ipsec_test.c",
        "patchSetId": 2
      },
      "lineNbr": 63,
      "author": {
        "id": 2465
      },
      "writtenOn": "2022-05-19T08:45:09Z",
      "side": 1,
      "message": "Ah yep - true - I was misremembering how it worked it there but you are right. It does show benefits of both.\n\nYour call then - it\u0027s a good demo, so I was leaning towards leaving it in. Maybe it introduces additional maintenance in future, that\u0027s the only downside for including it I can think of.",
      "parentUuid": "9a73e2f4_77ca4e37",
      "revId": "4975a246c4d869861c6a2878e92c3b22cdf6fc47",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    }
  ]
}
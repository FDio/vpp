{
  "comments": [
    {
      "key": {
        "uuid": "fd75d75b_3f99b06c",
        "filename": "src/svm/fifo_segment.c",
        "patchSetId": 45
      },
      "lineNbr": 749,
      "author": {
        "id": 1561
      },
      "writtenOn": "2020-01-15T12:41:31Z",
      "side": 1,
      "message": "This may cause SEGV if the given chunk_size is too big (so the fl_index is too big).",
      "revId": "c73b67b579e0ea0689582c4a2ecb7ff293e9ddd8",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "637fe788_1ffc0c0b",
        "filename": "src/svm/fifo_segment.c",
        "patchSetId": 45
      },
      "lineNbr": 749,
      "author": {
        "id": 193
      },
      "writtenOn": "2020-01-15T15:41:31Z",
      "side": 1,
      "message": "When we initialize free_chunks in fifo_segment_init, we make sure we initialize up to  fsh-\u003emax_log2_chunk_size. \n\nSo if this ever crashes, something is wrong.",
      "parentUuid": "fd75d75b_3f99b06c",
      "revId": "c73b67b579e0ea0689582c4a2ecb7ff293e9ddd8",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5db34379_954072ff",
        "filename": "src/svm/fifo_segment.c",
        "patchSetId": 45
      },
      "lineNbr": 749,
      "author": {
        "id": 1561
      },
      "writtenOn": "2020-01-15T17:32:03Z",
      "side": 1,
      "message": "I mean, if the caller calls this function with chunk_size which is larger than fsh-\u003emax_log2_chunk_size, fs_freelist_for_size() provides the invalidly large index. So fss-\u003efree_chunks[fl_index] is out of the boundary of the array.\n\nAnyway, I see that the caller should pay attention to not request too large chunk. And it won\u0027t happen if the tuning-logic is enough intelligent.",
      "parentUuid": "637fe788_1ffc0c0b",
      "revId": "c73b67b579e0ea0689582c4a2ecb7ff293e9ddd8",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "060b33b6_00e30fe1",
        "filename": "src/svm/fifo_segment.c",
        "patchSetId": 45
      },
      "lineNbr": 749,
      "author": {
        "id": 193
      },
      "writtenOn": "2020-01-15T17:46:43Z",
      "side": 1,
      "message": "max_log2_chunk_size is supposed to be log2(segment_size / 2). So that is large enough to accomodate 2 fifo chunks half of the size of the segment. Fifos will never be larger than that when allocated and as long as the fifo tuning logic takes care not to increment fifo size beyond that maximum size, this should not happen. If it does, it\u0027ll be a bug on the fifo tuning logic side.\n\nSo, because things are implicitly capped, we should avoid constantly validating all the input, especially on code paths that are often exercised.",
      "parentUuid": "5db34379_954072ff",
      "revId": "c73b67b579e0ea0689582c4a2ecb7ff293e9ddd8",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "02629e34_762185db",
        "filename": "src/svm/fifo_segment.c",
        "patchSetId": 45
      },
      "lineNbr": 749,
      "author": {
        "id": 1561
      },
      "writtenOn": "2020-01-16T14:46:45Z",
      "side": 1,
      "message": "I see. I agree it is reasonable to omit that validation.",
      "parentUuid": "060b33b6_00e30fe1",
      "revId": "c73b67b579e0ea0689582c4a2ecb7ff293e9ddd8",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e1a9b090_046c349a",
        "filename": "src/svm/svm_fifo.c",
        "patchSetId": 45
      },
      "lineNbr": 71,
      "author": {
        "id": 1561
      },
      "writtenOn": "2020-01-15T15:31:05Z",
      "side": 1,
      "message": "NULL-check for c is needed here.",
      "revId": "c73b67b579e0ea0689582c4a2ecb7ff293e9ddd8",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "736aaa4d_d7f0240d",
        "filename": "src/svm/svm_fifo.c",
        "patchSetId": 45
      },
      "lineNbr": 71,
      "author": {
        "id": 193
      },
      "writtenOn": "2020-01-15T15:43:05Z",
      "side": 1,
      "message": "We should not go under any circumstances beyond the end of the fifo. The callers make sure with f_grow_fifo that enough chunks were allocated.",
      "parentUuid": "e1a9b090_046c349a",
      "revId": "c73b67b579e0ea0689582c4a2ecb7ff293e9ddd8",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "192db14a_c1c60929",
        "filename": "src/svm/svm_fifo.c",
        "patchSetId": 45
      },
      "lineNbr": 71,
      "author": {
        "id": 1561
      },
      "writtenOn": "2020-01-15T17:32:03Z",
      "side": 1,
      "message": "OK.",
      "parentUuid": "736aaa4d_d7f0240d",
      "revId": "c73b67b579e0ea0689582c4a2ecb7ff293e9ddd8",
      "serverId": "6d2eb258-4fe2-443e-8a38-ca81da23d4c2",
      "unresolved": true
    }
  ]
}